-- Use a very weak pseudo-number generator just for testing purpose.
var my_random = fn(s)
    s.x = (16807 * s.x) % 2147483647
    return s.x % 50


var foo = fn(a)
    var s = { x = 13 }
    var ls = { }
    ::a::
    var x = 2*a + 1
    ls[#ls+1] = fn() 
        return x 
    if my_random(s) < 10 
        goto a 
    ::b::
    ls[#ls+1] = fn() 
        return x 
    if my_random(s) < 20 
        goto b 
    ::c::
    var y = x^2 + 1
    ls[#ls+1] = fn() 
        return y 
    if my_random(s) < 40 
        goto a 

    return ls


var ls = foo(7)
for i = 1, #ls
    print(ls[i]())

