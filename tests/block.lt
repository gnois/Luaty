-- test comment and indentation
	-- vvv
		-- vvv

var split = \str, pattern, plain ->
	var arr = {}
	if pattern and #pattern > 0
		var pos = 1
		for st, sp in -> return string.find(str, pattern, pos, plain)
			table.insert(arr, string.sub(str, pos, st-1))
			pos = sp + 1
		table.insert(arr, string.sub(str, pos))
	return arr



var self = {}

self.qqq = \@ ->


	-- FIXME


self.xxx = \@, line ->
	var a = 1   -- comment
	var b = 2
	return a + b

assert(self.xxx() == 3)


